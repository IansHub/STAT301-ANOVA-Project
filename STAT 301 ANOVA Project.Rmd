---
title: "STAT 301 ANOVA Project"
output: word_document
date: "2025-04-06"
---

##Importing Necessary Libraries
```{r}
library(dplyr)
library(multcomp)
library(nlme)
library(ggplot2)
```

##Data Preparation
```{r}

CycledAir_df <- data.frame(JulyCycledAirData)

#Check range of IV readings
range(CycledAir_df$Temperature)
range(CycledAir_df$Humidity)
range(CycledAir_df$HeatIndex)

#Add a column of categorical ordinal temperature ranges for use in ANOVA
temp_breaks <- c(48, 60, 70, 90)
temp_labels <- c("Low", "Medium", "High")

humidity_breaks <- c(42, 60, 77, 94)
humidity_labels <- c("Low", "Medium", "High")


CycledAir_df$HumidityRange <- cut(
  CycledAir_df$Humidity,
  breaks = humidity_breaks,
  labels = humidity_labels,
  include.lowest = TRUE
)

CycledAir_df$TempRange <- cut(
  CycledAir_df$Temperature,
  breaks = temp_breaks,
  labels = temp_labels,
  include.lowest = TRUE
)
```

```{r}
CycledAir_df$Reading <- na_if(CycledAir_df$Reading, "NA")
sum(is.na(CycledAir_df$Reading))
anova_result <- aov(Reading ~ TempRange*LoadControl*HumidityRange, data = CycledAir_df)
summary(anova_result)
TukeyHSD(anova_result)
```




```{r}
#Analysis
UsageModel<-lme(Reading~TempRange+HumidityRange+TempRange*HumidityRange+LoadControl+TempRange*LoadControl+HumidityRange*LoadControl,random = ~ 1| MeterID, data= CycledAir_df)
anova(UsageModel)

UsageModel<-lme(Reading~TempRange+HumidityRange+TempRange*HumidityRange,random = ~ 1| MeterID, data= CycledAir_df)

anova_result <- aov(Reading ~ LoadControl, data = CycledAir_df)
summary(anova_result)
TukeyHSD(anova_result)
